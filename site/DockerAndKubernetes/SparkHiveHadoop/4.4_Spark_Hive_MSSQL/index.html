<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Spark-Hive_MSSQL - My Docs</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">My Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../../.." class="nav-link">Welcome to MkDocs</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Airflow</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Airflow/1.0.0_AirFlow_Concepts/" class="dropdown-item">Airflow Concepts</a>
</li>
                                    
<li>
    <a href="../../../Airflow/1.0.1_A_Dags_Anatomy/" class="dropdown-item">A dags anatomy</a>
</li>
                                    
<li>
    <a href="../../../Airflow/1.0.2_Hello_Airflow/" class="dropdown-item">Hello-Airflow</a>
</li>
                                    
<li>
    <a href="../../../Airflow/1.0.3_Airflow_Dbt_Docker/" class="dropdown-item">Project Airflow dbt</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">DE Projects</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../DE-Projects/Csv-To-MSSQL/" class="dropdown-item">Python - CSV To MSSQL</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/CurrencyPredictor/" class="dropdown-item">CurrencyPredictor</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/Dbrk-E2E-AttritionProject/" class="dropdown-item">Problem Statement</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/Download-Haddop-Jars/" class="dropdown-item">Download JARs-Apache Maven Repo</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/FetchJsonWriteParquet/" class="dropdown-item">Json To Parquet Using Spark And Azure</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/InstallScala/" class="dropdown-item">Scala Install</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/JsonFlatAzureSDK/" class="dropdown-item">Flatten Json Using Azure SDK</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/LocalPython_AzureBlob/" class="dropdown-item">Local Python Code to Rearrange Files in a Azure Blob Container</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/Microsoft_OpenJDK/" class="dropdown-item">Microsoft OpenJDK</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/Project_MigrationToAzureBlob/" class="dropdown-item">CMS Migration to Azure Blob</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/Project_MongoCMS/" class="dropdown-item">CMS using MongoDB</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/Project_SSRS_SSIS_SharePoint/" class="dropdown-item">Project - ETL and Reporting Lending Org</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/Raw-Json-To-Hive/" class="dropdown-item">Raw Json To Hive</a>
</li>
                                    
<li>
    <a href="../../../DE-Projects/SPY_ETF_Buy_Recommender/" class="dropdown-item">SPY ETF Buy Recommender</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">AzureSkyWeather</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../DE-Projects/AzureSkyWeather/HomeProjectAzureSkyWeather/" class="dropdown-item">Project AzureSkyWeather</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">1 Ingestion</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">HttpTriggered</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../DE-Projects/AzureSkyWeather/1_Ingestion/HttpTriggered/HTTPTriggered_AzureFunc/" class="dropdown-item">Part 1A - Using Azure HTTP-Triggered Function</a>
</li>
            
<li>
    <a href="../../../DE-Projects/AzureSkyWeather/1_Ingestion/HttpTriggered/nav2_AzureFunctions/" class="dropdown-item">Azure Functions Quickstart</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">TimerTriggered</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../DE-Projects/AzureSkyWeather/1_Ingestion/TimerTriggered/TimerTriggered_AzureFunc/" class="dropdown-item">Part 1B - Using Azure Timer-Triggered Function</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2 Transformation</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../DE-Projects/AzureSkyWeather/2_Transformation/Solution_Details/" class="dropdown-item">Solution Details</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">JsonValidator</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../DE-Projects/JsonValidator/AzureFunction-ValidateJSOns/" class="dropdown-item">Azure Functions - Validate JSONs</a>
</li>
            
<li>
    <a href="../../../DE-Projects/JsonValidator/Python-ValidateJSONs/" class="dropdown-item">Validate JSON using Python</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Sparkzure</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../DE-Projects/Sparkzure/HomeProjectSparkzure/" class="dropdown-item">Project Sparkzure</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">StreamKraft</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../DE-Projects/StreamKraft/HomeProjectStreamKraft/" class="dropdown-item">Project StreamKraft</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">DevOps</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../DevOps/1.1_Hello_GitHub_Actions_Workflow/" class="dropdown-item">Hello GitHub Actions Workflow</a>
</li>
                                    
<li>
    <a href="../../../DevOps/1.1_Sample_Workflows/" class="dropdown-item">Sample Workflows</a>
</li>
                                    
<li>
    <a href="../../../DevOps/1_GitHub-Concepts/" class="dropdown-item">GitHub Concepts</a>
</li>
                                    
<li>
    <a href="../../../DevOps/2.1_Self-Hosted_Agent_Windows/" class="dropdown-item">Self-Hosted-Agent-Windows</a>
</li>
                                    
<li>
    <a href="../../../DevOps/2.2_Self-Hosted_Agent_Windows_Container/" class="dropdown-item">Self-Hosted-Agent-Win-Container</a>
</li>
                                    
<li>
    <a href="../../../DevOps/2.3_Self-Hosted_Agent_Linux_Container/" class="dropdown-item">Self-Hosted-Agent-Ubuntu-Container</a>
</li>
                                    
<li>
    <a href="../../../DevOps/2_Azure-Pipelines/" class="dropdown-item">Azure-Pipelines</a>
</li>
                                    
<li>
    <a href="../../../DevOps/ADF_CICD/" class="dropdown-item">ADF-CI-CD</a>
</li>
                                    
<li>
    <a href="../../../DevOps/Biceps/" class="dropdown-item">What is Bicep?</a>
</li>
                                    
<li>
    <a href="../../../DevOps/CI-CD_in%20ADF/" class="dropdown-item">CI CD in ADF</a>
</li>
                                    
<li>
    <a href="../../../DevOps/GitScenarios/" class="dropdown-item">GitScenarios</a>
</li>
                                    
<li>
    <a href="../../../DevOps/JenkinsVsGitHubVsAzureDevOps/" class="dropdown-item">Jenkins Vs GitHub Vs Devops</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">DockerAndKubernetes</a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">AirflowDocker</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../AirflowDocker/1_AirflowDocker/" class="dropdown-item">Airflow</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Kafka</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Kafka/2_Confluent%20Kafka/" class="dropdown-item">Confluent Kafka</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Mongodb</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Mongodb/3_DockerMongodb/" class="dropdown-item">MongoDB</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SparkHiveHadoop</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../4.1_PySpark/" class="dropdown-item">PySpark</a>
</li>
            
<li>
    <a href="../4.2_Bitnami_Spark_Cluster/" class="dropdown-item">Bitnami Spark</a>
</li>
            
<li>
    <a href="../4.3_VSCode_Docker_Connection/" class="dropdown-item">VSCode-Docker-Connection</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Spark-Hive_MSSQL</a>
</li>
            
<li>
    <a href="../4.5_Hadoop_Cluster_Single_N_MultiNode/" class="dropdown-item">Hadoop Cluster</a>
</li>
            
<li>
    <a href="../4.6_Hive_Hadooop_Postgres_Presto/" class="dropdown-item">bde2020-Hive-Hadoop-Presto</a>
</li>
            
<li>
    <a href="../4.7_Hadoop_Hive_SingleNode_MySQL/" class="dropdown-item">Hive-Hadoop-MySQL-SingleNode</a>
</li>
            
<li>
    <a href="../4.8_Hive-ApacheOfficial/" class="dropdown-item">Hive Official Setup</a>
</li>
            
<li>
    <a href="../4.9.1_Hive_Concepts/" class="dropdown-item">Hive Concepts</a>
</li>
            
<li>
    <a href="../4.9.2_Hadoop_Concepts/" class="dropdown-item">Hadoop Concepts</a>
</li>
            
<li>
    <a href="../4.9_DockerConcepts/" class="dropdown-item">Docker Misc Concepts</a>
</li>
            
<li>
    <a href="../4_Spark-Hive-Hadoop/" class="dropdown-item">4 Spark Hive Hadoop</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">M365</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../M365/DocumentumToSharePoint/" class="dropdown-item">Documentum-SharePoint Online</a>
</li>
                                    
<li>
    <a href="../../../M365/LicensingExamples/" class="dropdown-item">M365 Licensing Examples</a>
</li>
                                    
<li>
    <a href="../../../M365/SPMT/" class="dropdown-item">SPMT - SharePoint Migration</a>
</li>
                                    
<li>
    <a href="../../../M365/SharePoint2007FarmUpgrade/" class="dropdown-item">SharePoint Farm Upgrade</a>
</li>
                                    
<li>
    <a href="../../../M365/SharePoint2016FarmUpgrade/" class="dropdown-item">SharePoint Farm 2016 Farm Setup</a>
</li>
                                    
<li>
    <a href="../../../M365/SharePointEvents/" class="dropdown-item">SharePoint Event Receiver</a>
</li>
                                    
<li>
    <a href="../../../M365/SharePointFarmConsolidation/" class="dropdown-item">SharePoint Farm Consolidation</a>
</li>
                                    
<li>
    <a href="../../../M365/SharePointFormsOrPowerApps/" class="dropdown-item">SharePoint Forms or PowerApps</a>
</li>
                                    
<li>
    <a href="../../../M365/SharePointMiniRole/" class="dropdown-item">SharePoint Mini Role</a>
</li>
                                    
<li>
    <a href="../../../M365/SharePointVersionEvolution/" class="dropdown-item">SharePoint Evolution</a>
</li>
                                    
<li>
    <a href="../../../M365/SharePointVsOtherECM/" class="dropdown-item">SharePoint vs Other ECMS</a>
</li>
                                    
<li>
    <a href="../../../M365/WSS3DocumentUpload/" class="dropdown-item">Project - C# - WSS 3 Bulk ingestion</a>
</li>
                                    
<li>
    <a href="../../../M365/oAuthSharePointPython/" class="dropdown-item">Python-oAuth-SharePointOnline</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Microsoft Fabric</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Microsoft-Fabric/DataFactory/" class="dropdown-item">Pipelines&DataFlows</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/DataScience/" class="dropdown-item">Data Science on Fabric Overview</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/DataWareHouse/" class="dropdown-item">DataWareHouse</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/DirectLake/" class="dropdown-item">DirectLake|Fabric|PowerBI</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/E2EProject/" class="dropdown-item">E2EProject</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/ETL-OPG-Copydata-JSON-Lakehouse/" class="dropdown-item">JSON-DeltaLake-OPG</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/ETL-Pyspark-Notebook-Lakehouse/" class="dropdown-item">ETL-Load data into Lakehouse - Pyspark Notebook</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/FabricAdministration/" class="dropdown-item">Administration</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/FabricQ%26A/" class="dropdown-item">Fabric Q&A</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/FabricSparkStreaming/" class="dropdown-item">Spark Streaming</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/HelloMicrosoftFabric/" class="dropdown-item">Hello Fabric</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/InspectingDataframes/" class="dropdown-item">Whats in your df?</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/KQL/" class="dropdown-item">KQL</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/PandasVsSparkDf/" class="dropdown-item">PandasVsSparkDf</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/Pyspark_SparkSQL/" class="dropdown-item">Pyspark|SparkSQL CheatSheet</a>
</li>
                                    
<li>
    <a href="../../../Microsoft-Fabric/RealTimeAnalytics/" class="dropdown-item">Real-time Intelligence</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Misc</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Misc/10_Fact_vs_Dimension_tables/" class="dropdown-item">Fact Vs Dimension Table</a>
</li>
                                    
<li>
    <a href="../../../Misc/1_GoogleCloudSeeUsage/" class="dropdown-item">Check Google Usage</a>
</li>
                                    
<li>
    <a href="../../../Misc/2_InstallVMWareFree/" class="dropdown-item">VMWare For Free</a>
</li>
                                    
<li>
    <a href="../../../Misc/3_Markdown/" class="dropdown-item">Markdown</a>
</li>
                                    
<li>
    <a href="../../../Misc/4_VSTrics/" class="dropdown-item">Visual Studio Code Tricks</a>
</li>
                                    
<li>
    <a href="../../../Misc/5_WhichDatastsToUse/" class="dropdown-item">Free Datasets for Data Practice</a>
</li>
                                    
<li>
    <a href="../../../Misc/6_RunningAppsInBg/" class="dropdown-item">Running Service in Background</a>
</li>
                                    
<li>
    <a href="../../../Misc/7_Azure_Budget/" class="dropdown-item">How to set a Azure Budget</a>
</li>
                                    
<li>
    <a href="../../../Misc/9_WhyUbuntuIsGood/" class="dropdown-item">Why Ubuntu is good to learn</a>
</li>
                                    
<li>
    <a href="../../../Misc/markdown_pdf_export_html/" class="dropdown-item">Markdown pdf export html</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">MarkdownColor.md</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../Misc/MarkdownColor.md/Color/" class="dropdown-item">Color Reference</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Images</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../Misc/MarkdownColor.md/images/Color/" class="dropdown-item">Color Palettes</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">MongoDB</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../MongoDB/HowMongoDBStoresFiles/" class="dropdown-item">How MongoDB Stores Data</a>
</li>
                                    
<li>
    <a href="../../../MongoDB/MongbDB_Vs_Atlas_VsCosmosDB/" class="dropdown-item">MongoDB Vs CosmosDB</a>
</li>
                                    
<li>
    <a href="../../../MongoDB/MongoDBCommands/" class="dropdown-item">MongoDB Commands</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">PowerPlatform</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../PowerPlatform/CalculationGroups/" class="dropdown-item">CalculationGroups</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/CustomConnectors/" class="dropdown-item">Building Custom Connectors</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/ECMCaptureFlow/" class="dropdown-item">Power Automate Or Kofax/Captiva?</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/EnableMicrosoftSyntex/" class="dropdown-item">Enable Microsoft Syntex on your Office 365 tenant</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/EnableSyntexOnYourDocumentLibrary/" class="dropdown-item">Create a model on SharePoint - Syntex</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/GoogleProviderPowerPages/" class="dropdown-item">Google Authentication</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/HealthClinicDataverseSecurity/" class="dropdown-item">HealthClinicDataverseSecurity</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/HelloDataverse/" class="dropdown-item">Hello Dataverse</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/HelloDynamics365/" class="dropdown-item">Dynamics 365 Ecosystem</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/HelloPowerPlatform/" class="dropdown-item">PowerPlatform Ecosystem</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/ModelDrivenApps/" class="dropdown-item">Model-Driven Apps</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/OnPremiseGateway/" class="dropdown-item">Onpremise Gateway</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/PowerAutomateIsWorkflowTeams/" class="dropdown-item">Workflow is Power Automate</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/PowerPlatformAdminCentral/" class="dropdown-item">PowerPlatformAdminCentral</a>
</li>
                                    
<li>
    <a href="../../../PowerPlatform/PowerPlatformQ%26A/" class="dropdown-item">Pl-900-Q&A</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">DocumentIntelligence</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../PowerPlatform/DocumentIntelligence/AAIDI_AzureCognitiveSearch/" class="dropdown-item">Integrate AI Search and Azure AI Document Intelligence</a>
</li>
            
<li>
    <a href="../../../PowerPlatform/DocumentIntelligence/AAIDI_Q%26A/" class="dropdown-item">AAIDI Q&A</a>
</li>
            
<li>
    <a href="../../../PowerPlatform/DocumentIntelligence/AzureAIDocumentIntelligence/" class="dropdown-item">Azure AI Document Intelligence</a>
</li>
            
<li>
    <a href="../../../PowerPlatform/DocumentIntelligence/DocumentAutomation/" class="dropdown-item">Document automation base kit</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Python</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Python/1.0_Sets/" class="dropdown-item">Sets</a>
</li>
                                    
<li>
    <a href="../../../Python/1.1.0_assert_methods/" class="dropdown-item">assert methods</a>
</li>
                                    
<li>
    <a href="../../../Python/1.1.1_decorators/" class="dropdown-item">decorators</a>
</li>
                                    
<li>
    <a href="../../../Python/1.1.2_argv/" class="dropdown-item">argv</a>
</li>
                                    
<li>
    <a href="../../../Python/1.1.3_Diff_And_Patch/" class="dropdown-item">diffAndpatch</a>
</li>
                                    
<li>
    <a href="../../../Python/1.1.3_error_handling/" class="dropdown-item">Error Handling</a>
</li>
                                    
<li>
    <a href="../../../Python/1.1.4_pdb/" class="dropdown-item">pdb</a>
</li>
                                    
<li>
    <a href="../../../Python/1.1.5_pyformat/" class="dropdown-item">format method</a>
</li>
                                    
<li>
    <a href="../../../Python/1.10_Func_Modl_Summary/" class="dropdown-item">LFM Summary</a>
</li>
                                    
<li>
    <a href="../../../Python/1.11_ifelifelse/" class="dropdown-item">ifelifelse</a>
</li>
                                    
<li>
    <a href="../../../Python/1.12_Operators/" class="dropdown-item">operators</a>
</li>
                                    
<li>
    <a href="../../../Python/1.13_For_Loops/" class="dropdown-item">for loops</a>
</li>
                                    
<li>
    <a href="../../../Python/1.14_enumerate/" class="dropdown-item">1.14 enumerate</a>
</li>
                                    
<li>
    <a href="../../../Python/1.15_range_function/" class="dropdown-item">range function</a>
</li>
                                    
<li>
    <a href="../../../Python/1.16_built_in_functions/" class="dropdown-item">1.16 built in functions</a>
</li>
                                    
<li>
    <a href="../../../Python/1.17_withStatement/" class="dropdown-item">with statement</a>
</li>
                                    
<li>
    <a href="../../../Python/1.18_unittest_pytest/" class="dropdown-item">pytest</a>
</li>
                                    
<li>
    <a href="../../../Python/1.19_if_name_main.md/" class="dropdown-item">if__name__main</a>
</li>
                                    
<li>
    <a href="../../../Python/1.1_Tuples/" class="dropdown-item">Tuples</a>
</li>
                                    
<li>
    <a href="../../../Python/1.2_Tuples_Advanced/" class="dropdown-item">Advanced Tuples</a>
</li>
                                    
<li>
    <a href="../../../Python/1.3_List/" class="dropdown-item">1.3 List</a>
</li>
                                    
<li>
    <a href="../../../Python/1.4_Dictionaries/" class="dropdown-item">1.4 Dictionaries</a>
</li>
                                    
<li>
    <a href="../../../Python/1.5_Lamda_Functions/" class="dropdown-item">Lamda Functions</a>
</li>
                                    
<li>
    <a href="../../../Python/1.9_Func_Modl_Lib/" class="dropdown-item">Library-Modules-Funcs</a>
</li>
                                    
<li>
    <a href="../../../Python/1_Python/" class="dropdown-item">Python</a>
</li>
                                    
<li>
    <a href="../../../Python/Linux/" class="dropdown-item">Essential Unix Commands</a>
</li>
                                    
<li>
    <a href="../../../Python/Pyspark/" class="dropdown-item">PySpark</a>
</li>
                                    
<li>
    <a href="../../../Python/PythonScripts/" class="dropdown-item">Python Sample Scripts</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">GraphAPIJupyter</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../Python/GraphAPIJupyter/GraphAPIUsingJuputer/" class="dropdown-item">Graph API - Juputer</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">SQL</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../SQL/1.0.0_dbt/" class="dropdown-item">dbt</a>
</li>
                                    
<li>
    <a href="../../../SQL/1.0.1_setup_simple_dbt_project/" class="dropdown-item">1.0.1 setup simple dbt project</a>
</li>
                                    
<li>
    <a href="../../../SQL/FlatFileSoure/" class="dropdown-item">FlatFileSoure</a>
</li>
                                    
<li>
    <a href="../../../SQL/InputAndOutputProperties/" class="dropdown-item">Understanding External Columns and Output Columns in SSIS</a>
</li>
                                    
<li>
    <a href="../../../SQL/MSSQL_Versions/" class="dropdown-item">SQL Server Versions</a>
</li>
                                    
<li>
    <a href="../../../SQL/Project_1-ETL-CSV-MSSQL/" class="dropdown-item">Project 1 - ETL Flat Files to MSSQL</a>
</li>
                                    
<li>
    <a href="../../../SQL/Project_2-UsingWebServicesInSSIS/" class="dropdown-item">Project 2 - Web Service SSIS Script Task</a>
</li>
                                    
<li>
    <a href="../../../SQL/SQL/" class="dropdown-item">Spark-SQL</a>
</li>
                                    
<li>
    <a href="../../../SQL/SQL_AdvancedTopics/" class="dropdown-item">SQL Advanced Topics</a>
</li>
                                    
<li>
    <a href="../../../SQL/SSIS/" class="dropdown-item">SQL Server Integration Services</a>
</li>
                                    
<li>
    <a href="../../../SQL/SSRS/" class="dropdown-item">SSRS</a>
</li>
                                    
<li>
    <a href="../../../SQL/Windows_Functions/" class="dropdown-item">Window Functions</a>
</li>
                                    
<li>
    <a href="../../../SQL/connecting-with-dbt/" class="dropdown-item">Connect Local dbt with MSSQL Server</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Spark DataBricks</a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">1.0 Spark</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.0_Spark-Concepts/" class="dropdown-item">Spark</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.10_Scala_Cheatsheet/" class="dropdown-item">Scala Cheatsheet</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.11_Spark_Interview_Questions/" class="dropdown-item">Spark Interview Questions</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.12_Spark_Shuffle/" class="dropdown-item">Shuffle in Spark</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.13_SparkDatabaseTablesCatalogsMetastore/" class="dropdown-item">Spark DB-Tables-Metastore-Catalogs</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.14_Q%26A/" class="dropdown-item">Q&A</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.15_CommonPysparkTopics/" class="dropdown-item">PySpark Concepts I</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.16_ConnectingSparkToHive/" class="dropdown-item">Spark-Hive-Delta Connection</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.1_NarrowVsWideTransformation/" class="dropdown-item">Narrow_Vs_Wide_Transformation</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.2_SparkArchitecture/" class="dropdown-item">Spark Architecture</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.3_persist_and_cache/" class="dropdown-item">persist and cache</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.4_broadcastvariables/" class="dropdown-item">Broadcast Variables</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.5_DataSkewHandling/" class="dropdown-item">Data Skew in Spark</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.6_dropna_fillna_df_missing_val_handling/" class="dropdown-item">dropna and fillna</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.7_distinct_dropDuplicate_windowsFunc/" class="dropdown-item">Removing Duplicates - PySpark</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.8_Partition_Grouping/" class="dropdown-item">Partition And Bucket</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/1.9_RDD_Dataframe_Dataset/" class="dropdown-item">RDD-Dataframe-Dataset</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Install Pyspark Windows</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../Spark-DataBricks/1.0_Spark/Install-Pyspark-Windows/Install-Pyspark-Windows/" class="dropdown-item">Install-PySpark-Windows</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2.0 Spark To ADLS</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../Spark-DataBricks/2.0_Spark_To_ADLS/2.0_Spark_To_ADLS/" class="dropdown-item">Spark-To-ADLS-Connection</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/2.0_Spark_To_ADLS/2.1_Spark-To_ADLS_Summary/" class="dropdown-item">Spark-To-ADLS-Summary</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">3.0 Databricks</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../Spark-DataBricks/3.0_Databricks/3.0_Databricks_Concepts/" class="dropdown-item">Databricks</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/3.0_Databricks/3.1_Catalogs_And_Metastore/" class="dropdown-item">Hive Metastore and the hive_metastore folder</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/3.0_Databricks/3.2_AuthenticationMethods/" class="dropdown-item">Authentication Method</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/3.0_Databricks/3.3_Mount_ADLS_on_Databricks/" class="dropdown-item">Mount ADLS on Databricks</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/3.0_Databricks/3.4_Databricks_Secret_Scope/" class="dropdown-item">Secret Scope</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/3.0_Databricks/3.5_Databricks_SQL/" class="dropdown-item">CREATE TABLE USING</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/3.0_Databricks/3.6_DatabricksMagicCommands/" class="dropdown-item">Magic Commands</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/3.0_Databricks/3.7_DeltaLake_And_Lakehouse/" class="dropdown-item">Delta Lake And Lakehouse</a>
</li>
            
<li>
    <a href="../../../Spark-DataBricks/3.0_Databricks/4.8_Databricks_ProjectA1/" class="dropdown-item">Project-A</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">4.0 Hive</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../Spark-DataBricks/4.0_Hive/Hive_Concepts/" class="dropdown-item">Hive Concepts</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">StreamProcessing</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../StreamProcessing/1.0_What_Is_Stream_Processing/" class="dropdown-item">1.0 What Is Stream Processing</a>
</li>
                                    
<li>
    <a href="../../../StreamProcessing/2.0.1_EventHubs_Vs_Kafka/" class="dropdown-item">EventHubs Vs Kafka</a>
</li>
                                    
<li>
    <a href="../../../StreamProcessing/2.0.2_Project_Hello_EventHubs/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../../StreamProcessing/2.0.3_EventHubsLocalEmulator/" class="dropdown-item">Event Hubs Emulator - End to End</a>
</li>
                                    
<li>
    <a href="../../../StreamProcessing/2.0_Azure_EventHubs/" class="dropdown-item">EventHubs</a>
</li>
                                    
<li>
    <a href="../../../StreamProcessing/4_EventProcessingChoices/" class="dropdown-item">Stream Processing Product Combination</a>
</li>
                                    
<li>
    <a href="../../../StreamProcessing/5_AmazonKinesisSparkIntegration/" class="dropdown-item">5 AmazonKinesisSparkIntegration</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Synapse ADF</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Synapse-ADF/1.0_SynapseConcepts/" class="dropdown-item">SynapseConcepts</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/1.1_Pools/" class="dropdown-item">Pools</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/1.3_ETL%20Pipelines/" class="dropdown-item">ETL Pipelines</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/1.4_Copy-data-tool/" class="dropdown-item">ADF Copy task - When to use</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/1.5_IntegrationRuntime/" class="dropdown-item">Integration Runtime</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/1.6_DB_Types_In_Synapse/" class="dropdown-item">Types of DB in Synapse</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/1.7_SynapseLakeDBAndLakehouse/" class="dropdown-item">Lake DB-Lakehouse-Delta Lake</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/1.8_ADF_SA_Evolution/" class="dropdown-item">ADF & Synapse Evolution</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/1.9_CETAS/" class="dropdown-item">CETAS</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/2.0_Projects/" class="dropdown-item">2.0 Projects</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/2.1_Pipeline-Local-ADLS/" class="dropdown-item">CopyData-LocalToADLS</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/2.2_PySparkWarehouse/" class="dropdown-item">PysparkWarehouse</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/2.3_ADF_RestAPI_Databricks/" class="dropdown-item">2.3 ADF RestAPI Databricks</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/2.4_Monitor_ADF_Pipelines/" class="dropdown-item">ADF Pipelines Monitoring</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/2.5_ADF_Pipeline_Copy/" class="dropdown-item">Export ADF Pipeline</a>
</li>
                                    
<li>
    <a href="../../../Synapse-ADF/Q%26A/" class="dropdown-item">100 Synapse FAQs</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../4.3_VSCode_Docker_Connection/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../4.5_Hadoop_Cluster_Single_N_MultiNode/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#setup-a-complete-data-warehouse-with-spark-cluster-external-hivemssql-metastore" class="nav-link">Setup a complete data warehouse with Spark cluster &amp; external Hive(MSSQL Metastore)</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#for-the-busy-people" class="nav-link">For the busy people</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#how-was-the-setup-created" class="nav-link">How was the setup created</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#bit-background-about-bitnami-spark-container" class="nav-link">Bit Background About Bitnami Spark Container</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#spark-container-setup-details" class="nav-link">Spark container setup details</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#mssql-2019-container-setup-details" class="nav-link">MSSQL 2019 container setup details</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#hive-server-container-setup-details" class="nav-link">Hive Server container setup details</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#spark-defaultsconf-hive-sitexml" class="nav-link">spark-defaults.conf &amp; hive-site.xml</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#repository-and-metastore-folder-creation" class="nav-link">Repository and Metastore Folder Creation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#testing" class="nav-link">Testing</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#when-will-be-managed-or-external-tables-created" class="nav-link">When will be managed or external tables created?</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#errors" class="nav-link">Errors</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#server-details" class="nav-link">Server Details</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<ul>
<li><a href="#setup-a-complete-data-warehouse-with-spark-cluster--external-hivemssql-metastore">Setup a complete data warehouse with Spark cluster \&amp; external Hive(MSSQL Metastore)</a></li>
<li><a href="#for-the-busy-people">For the busy people</a></li>
<li><a href="#how-was-the-setup-created">How was the setup created</a></li>
<li><a href="#bit-background-about-bitnami-spark-container">Bit Background About Bitnami Spark Container</a><ul>
<li><a href="#their-dockerfile">Their Dockerfile</a></li>
<li><a href="#non-root-containers">Non-Root Containers</a></li>
<li><a href="#the-user-1001">The User 1001</a></li>
<li><a href="#folder-structure">Folder Structure</a></li>
</ul>
</li>
<li><a href="#spark-container-setup-details">Spark container setup details</a></li>
<li><a href="#mssql-2019-container-setup-details">MSSQL 2019 container setup details</a></li>
<li><a href="#hive-server-container-setup-details">Hive Server container setup details</a><ul>
<li><a href="#hive-mssql-connection">Hive-MSSQL Connection</a></li>
</ul>
</li>
<li><a href="#spark-defaultsconf--hive-sitexml">spark-defaults.conf \&amp; hive-site.xml</a><ul>
<li><a href="#spark-defaultsconf--hive-sitexml-1">spark-defaults.conf \&amp; hive-site.xml</a></li>
<li><a href="#spark-defaultsconf-important-details">spark-defaults.conf important details</a></li>
<li><a href="#hive-site-important-details">hive-site important details</a></li>
</ul>
</li>
<li><a href="#repository-and-metastore-folder-creation">Repository and Metastore Folder Creation</a></li>
<li><a href="#testing">Testing</a></li>
<li><a href="#when-will-be-managed-or-external-tables-created">When will be managed or external tables created?</a></li>
<li><a href="#errors">Errors</a></li>
<li><a href="#server-details">Server Details</a></li>
</ul>
<h1 id="setup-a-complete-data-warehouse-with-spark-cluster-external-hivemssql-metastore"><span style="color: teal;">Setup a complete data warehouse with Spark cluster &amp; external Hive(MSSQL Metastore)</span></h1>
<p>Here, I will show you how to create a complete warehouse setup with a Spark Cluster and a standalone Hive with an external metastore database (MSSQL). The setup will use 5 containers:</p>
<table>
<thead>
<tr>
<th><strong>Service</strong></th>
<th><strong>URL/Connection</strong></th>
<th><strong>Image</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Spark Master</td>
<td><a href="http://localhost:16789/">http://localhost:16789/</a></td>
<td><code>spark:3.5.1-debian-12-r7</code></td>
</tr>
<tr>
<td>Spark Worker 1</td>
<td><a href="http://localhost:16791/">http://localhost:16791/</a></td>
<td><code>spark:3.5.1-debian-12-r7</code></td>
</tr>
<tr>
<td>Spark Worker 2</td>
<td><a href="http://localhost:16792/">http://localhost:16792/</a></td>
<td><code>spark:3.5.1-debian-12-r7</code></td>
</tr>
<tr>
<td>SQL Server (SSMS)</td>
<td><code>localhost,1433</code>, SQL Server Auth: <code>dwdas/Passw0rd</code></td>
<td><code>mcr.microsoft.com/mssql/server:2019-latest</code></td>
</tr>
<tr>
<td>Hive Metastore</td>
<td><code>thrift://hive-metastore:9083</code></td>
<td><code>apache/hive:4.0.0</code></td>
</tr>
</tbody>
</table>
<h2 id="for-the-busy-people"><span style="color: BlueViolet;">For the busy people</span></h2>
<p>Follow these steps to get your setup ready:</p>
<ul>
<li>Download the <a href="../Dockerfiles/spark-hive-mssql-dockerfiles.zip">zip</a> file on your laptop.</li>
<li>Go to <code>Step1xx</code>, <code>Step2xx</code>, and <code>Step3xx</code> folders and run <code>run.bat</code> in each.</li>
</ul>
<p>This will create a setup like the one shown below:</p>
<p><img alt="" src="../images/custom-image-2024-06-24-16-11-45.png" /></p>
<p>A shared volume should be present in the volumes with the mapping shown below:</p>
<p><img alt="" src="../images/custom-image-2024-06-24-16-12-32.png" /></p>
<p>Here are some important details about the setup:</p>
<h1 id="how-was-the-setup-created">How was the setup created</h1>
<h2 id="bit-background-about-bitnami-spark-container">Bit Background About Bitnami Spark Container</h2>
<h3 id="their-dockerfile">Their Dockerfile</h3>
<p>The official Dockerfile used by Bitnami to create their Spark container can be found on <a href="https://hub.docker.com/r/bitnami/spark/dockerfile">GitHub</a>. Some key parts of the file are:</p>
<pre><code class="language-dockerfile">RUN chown -R 1001:1001 /opt/bitnami/spark
WORKDIR /opt/bitnami/spark
USER 1001
ENTRYPOINT [ &quot;/opt/bitnami/scripts/spark/entrypoint.sh&quot; ]
CMD [ &quot;/opt/bitnami/scripts/spark/run.sh&quot; ]
</code></pre>
<h3 id="non-root-containers">Non-Root Containers</h3>
<p>By default, Bitnami containers run as non-root users. This means when you log into the container, you are not the root user. The container itself runs as a non-root user, but you can change this by specifying <code>User: root</code> in your Dockerfile or Docker-compose.</p>
<p>More details can be found <a href="https://docs.vmware.com/en/VMware-Tanzu-Application-Catalog/services/tutorials/GUID-why-non-root-containers-are-important-for-security-index.html">here</a>.</p>
<h3 id="the-user-1001">The User 1001</h3>
<p>Bitnami Spark containers use the non-root user ID 1001. When you start the container and log in, you will be user 1001. It's important that this user has access to all required directories and volumes. Ensure necessary permissions are set when building the container.</p>
<h3 id="folder-structure">Folder Structure</h3>
<p>Bitnami containers store application files in <code>/opt/bitnami/APPNAME/</code>. For example, Spark files are located in <code>/opt/bitnami/spark</code>. More details can be found in the <a href="https://docs.bitnami.com/aws/faq/get-started/understand-directory-structure/">Bitnami directory structure documentation</a>.</p>
<h2 id="spark-container-setup-details">Spark container setup details</h2>
<p>First, I created the Spark cluster using the Bitnami Spark image <code>bitnami/spark:3.5.1-debian-12-r7</code>. I chose Bitnami because it is popular and offers a constant version for stability. However, you can also use <code>bitnami/spark:latest</code>.</p>
<ul>
<li>I used a Dockerfile and docker-compose approach.</li>
<li>Created a <code>spark-defaults.conf</code> with just one setting:
   <code>text
   spark.sql.warehouse.dir = /data/spark-warehouse</code></li>
<li>Created a <code>Dockerfile</code> with the following important activities:</li>
<li>Created a <code>/data</code> folder.</li>
<li>Copied the custom <code>spark-defaults.conf</code> from laptop to <code>/conf</code>.</li>
<li>Set the root password and provided user 1001 permissions to /data folder.</li>
<li>
<p>Created a <code>docker-compose.yml</code> file that included these changes(rest are usual:
   ```yaml
   volumes:</p>
<ul>
<li>shared-data:/data</li>
<li>./spark-defaults.conf:/opt/bitnami/spark/conf/spark-defaults.conf
   environment:</li>
<li>SPARK_MODE=master  # Environment variable to set the Spark mode to master</li>
<li>SPARK_LOCAL_DIRS=/data/tmp  # Local directories for Spark
   ```</li>
</ul>
</li>
<li>
<p>Finally, created a <code>run.bat</code> to do the following:
   ```bat
   REM Create the Docker volume
   docker volume create shared-data</p>
</li>
</ul>
<p>REM Build and run the Docker Compose services
   docker-compose -p bitnami-spark-cluster build
   docker-compose -p bitnami-spark-cluster up -d
   ```</p>
<h2 id="mssql-2019-container-setup-details">MSSQL 2019 container setup details</h2>
<p>Setting up the MSSQL container was more straightforward and required less customization than the Spark cluster. I used a Dockerfile and docker-compose approach.</p>
<ul>
<li>Created a <code>Dockerfile</code> with the following important activities:</li>
<li>Created a user <code>dwdas</code> with the password <code>Passw0rd</code>.</li>
<li>
<p>Set the root user password to <code>Passw0rd</code>.</p>
</li>
<li>
<p>Created a <code>docker-compose.yml</code> file that included these changes:
   ```yaml
   ports:</p>
<ul>
<li>"1433:1433"  # Map port 1433 of the host to port 1433 of the container for MSSQL communication.
   environment:</li>
<li>SA_PASSWORD=Passw0rd  # Set the system administrator password for MSSQL.</li>
</ul>
</li>
</ul>
<p>networks:
     - spark-network
   ```</p>
<ul>
<li>Finally, created a <code>run.bat</code> to do the following:
   ```bat
   REM Create the Docker volumes. This is mapped to all Spark containers and the Hive container.
   docker volume create shared-data</li>
</ul>
<p>REM Build and run the Docker Compose services
   docker-compose -p bitnami-spark-cluster build
   docker-compose -p bitnami-spark-cluster up -d</p>
<p>REM Post-Setup: Create MSSQL user and database
   docker exec -it mssql-container-name /opt/mssql-tools/bin/sqlcmd -S localhost -U SA -P "Passw0rd" -Q "CREATE LOGIN dwdas WITH PASSWORD='Passw0rd'; CREATE DATABASE hive_metastore;"
   ```</p>
<blockquote>
<p>run.bat: After the container started, I created an MSSQL user <code>dwdas</code> with the password <code>Passw0rd</code> and an empty database <code>hive_metastore</code>. This was done inside the <code>run.bat</code> file.</p>
</blockquote>
<h2 id="hive-server-container-setup-details">Hive Server container setup details</h2>
<p>Setting up the Hive server can be very tricky. I used the official Apache Hive image with a Dockerfile and docker-compose approach.</p>
<ul>
<li><strong>Download JDBC Driver</strong>:</li>
<li>
<p>Downloaded <code>sqljdbc_7.2.2.0_enu.tar.gz</code> from <a href="https://www.microsoft.com/en-us/download/details.aspx?id=57782">Microsoft Download Center</a>.</p>
<p><img alt="" src="../images/custom-image-2024-06-24-16-42-53.png" /></p>
</li>
<li>
<p>Extracted the <code>mssql-jdbc-7.2.2.jre8.jar</code> driver to the current folder.</p>
</li>
<li>
<p><strong>Create a custom <code>hive-site.xml</code></strong>: Created a custom <code>hive-site.xml</code> with MSSQL connection information and directory configurations. Refer to the Step3-Hive/hive-site.xml in the setup folder for more details.</p>
</li>
<li>
<p><strong>Create a Dockerfile</strong>: Refer to the dockerfile in Step3-Hive folder for more details. Apart from usual activity these two steps are most immortant. I.e. placing the driver to the /lib and hive-site.xml to conf.
   <code>dockerfile
   COPY ./mssql-jdbc-7.2.2.jre8.jar /opt/hive/lib/
   COPY ./hive-site.xml /opt/hive/conf/</code></p>
</li>
<li>
<p><strong>Docker-compose Configuration</strong>: Apart from usual stuff the most important was to  the environment variable <code>DB_DRIVER=mssql</code>.</p>
</li>
<li>
<p><strong>Run.bat</strong>:</p>
</li>
<li>The <code>run.bat</code> script builds the images, runs the container.</li>
</ul>
<h3 id="hive-mssql-connection">Hive-MSSQL Connection</h3>
<p><img alt="" src="../images/2024-08-27-12-03-56.png" /></p>
<p>Apache Hive containers usually use a startup script called '/entrypoint.sh'. This script is set to use <strong>Derby</strong>(<em>${DB_DRIVER:=derby}</em>) database by default. To use MSSQL instead:</p>
<ol>
<li>Change the DB_DRIVER environment variable to 'mssql'.</li>
<li>Create an empty database called 'hive_metastore' on your MSSQL server.</li>
<li>Put your MSSQL connection and db  details in the 'hive-site.xml' file.</li>
<li>Add the MSSQL driver file (mssql-jdbc-7.2.2.jre8.jar) to the '/lib' folder.</li>
</ol>
<p><strong>/entrypoint.sh</strong></p>
<pre><code class="language-shell">#!/bin/bash
set -x

: ${DB_DRIVER:=derby}

SKIP_SCHEMA_INIT=&quot;${IS_RESUME:-false}&quot;

function initialize_hive {
  COMMAND=&quot;-initOrUpgradeSchema&quot;
  if [ &quot;$(echo &quot;$HIVE_VER&quot; | cut -d '.' -f1)&quot; -lt &quot;4&quot; ]; then
     COMMAND=&quot;-${SCHEMA_COMMAND:-initSchema}&quot;
  fi
  $HIVE_HOME/bin/schematool -dbType $DB_DRIVER $COMMAND
  if [ $? -eq 0 ]; then
    echo &quot;Initialized schema successfully..&quot;
  else
    echo &quot;Schema initialization failed!&quot;
    exit 1
  fi
}
# Additional script content...
</code></pre>
<p>So, how I did this:</p>
<ol>
<li>During mssql creation I already creatd the hive_metastore empty database and the user</li>
<li>The dockerfile managed the copying of the driver and the custom hive-site.xml
   <code>dockerfile
   COPY ./mssql-jdbc-7.2.2.jre8.jar /opt/hive/lib/
   COPY ./hive-site.xml /opt/hive/conf/</code></li>
<li>docker-compose managed set the  <code>DB_DRIVER=mssql</code></li>
</ol>
<p><strong>Note:</strong> An alternative approach to achieve the same feature would be to:</p>
<ol>
<li>Let the container start with the default settings.</li>
<li>Open <code>/entrypoint.sh</code> and change <code>${DB_DRIVER:=mssql}</code>.</li>
<li>Run <code>su -c "chmod 777 /entrypoint.sh"</code> with the password <code>Passw0rd</code> as the permission will change.</li>
<li>Copy <code>hive-site.xml</code> containing MSSQL connection info to <code>/opt/hive/conf/</code>.</li>
<li>Restart the container.</li>
</ol>
<h2 id="spark-defaultsconf-hive-sitexml">spark-defaults.conf &amp; hive-site.xml</h2>
<p>Only two configureation files were touched. Spark-defaults.conf  in spark server and hive-site.xml in hive server.</p>
<h3 id="spark-defaultsconf-hive-sitexml_1">spark-defaults.conf &amp; hive-site.xml</h3>
<h4 id="spark-defaultsconf-important-details">spark-defaults.conf important details</h4>
<p>Here, only one value was added. The same file is present in all the spark containres.
spark.sql.warehouse.dir=/data/spark-warehouse</p>
<h4 id="hive-site-important-details">hive-site important details</h4>
<pre><code class="language-xml"> &lt;property&gt;
    &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;
    &lt;value&gt;/data/hive-warehouse&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;
    &lt;value&gt;com.microsoft.sqlserver.jdbc.SQLServerDriver&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;
    &lt;value&gt;jdbc:sqlserver://mssql:1433;DatabaseName=hive_metastore;&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
  &lt;property&gt;
    &lt;name&gt;hive.metastore.uris&lt;/name&gt;
    &lt;value&gt;thrift://hive-metastore:9083&lt;/value&gt;
  &lt;/property&gt;
   &lt;property&gt;
    &lt;name&gt;hive.metastore.db.type&lt;/name&gt;
    &lt;value&gt;mssql&lt;/value&gt;
    &lt;description&gt;
      Expects one of [derby, oracle, mysql, mssql, postgres].
    &lt;/description&gt;
  &lt;/property&gt;
</code></pre>
<h2 id="repository-and-metastore-folder-creation">Repository and Metastore Folder Creation</h2>
<p>We have two options to decide on the folder structure:</p>
<p><strong>Our choice:</strong> Separate warehouses for Spark and Hive
1. Keep Hive warehouse as is:
   - In <code>hive-site.xml</code>:
     <code>xml
     &lt;property&gt;
       &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;
       &lt;value&gt;/data/hive/warehouse&lt;/value&gt;
     &lt;/property&gt;</code>
2. Set a different warehouse for Spark:
   - In Spark configuration:
    <code>spark.sql.warehouse.dir=/data/spark/warehouse</code></p>
<pre><code>/data
├── hive-warehouse/
│   └── (Hive managed tables)
├── spark-warehouse/
│   └── (Spark-managed tables)

</code></pre>
<p><strong>Option 2:</strong> Use Hive Warehouse for both Spark and Hive
1. Configure Spark to use the Hive metastore:
   - Set <code>spark.sql.hive.metastore.version</code> and <code>spark.sql.hive.metastore.jars</code> in Spark configuration.
2. Use the same warehouse directory for both:
   - In <code>hive-site.xml</code>:
     <code>xml
     &lt;property&gt;
       &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;
       &lt;value&gt;/data/spark-warehouse&lt;/value&gt;
     &lt;/property&gt;</code>
   - In Spark configuration. Using(<code>spark-defaults.conf</code>) or setting during session etc.
     <code>spark.sql.warehouse.dir=/data/spark-warehouse</code></p>
<h1 id="testing"><span style="color: Blue;">Testing</span></h1>
<p><strong>Testing Hive</strong>
Go the the hive container and type <strong>hive</strong>. You should see output lilke this:
<img alt="" src="../images/custom-image-2024-06-24-21-30-25.png" /></p>
<p><strong>Testing spark-shell</strong>
Go to any of hte spark containers's terminal and key in <strong>spark-shell</strong>, you should see output liek this:</p>
<p><img alt="" src="../images/custom-image-2024-06-25-23-52-53.png" /></p>
<p><strong>Testing spark-sql</strong>
Go to any of hte spark containers's terminal and key in <strong>spark-sql</strong>, you should see output liek this:</p>
<p><img alt="" src="../images/custom-image-2024-06-25-23-51-47.png" /></p>
<h1 id="when-will-be-managed-or-external-tables-created">When will be managed or external tables created?</h1>
<p>When configuring Spark to work with Hive, the type of table created (managed vs. external) depends on specific settings in your Spark configuration.</p>
<p>If <code>spark-defaults.xml</code> includes:</p>
<pre><code class="language-xml">spark.hadoop.hive.metastore.uris=thrift://hive-metastore:9083
</code></pre>
<p>Then, spark will create all tables as <code>EXTERNAL</code>. Regardless of whatever settigngs you try.</p>
<p><img alt="" src="../images/custom-image-2024-06-25-20-08-20.png" /></p>
<p>If <code>spark-defaults.xml</code> does not include:</p>
<pre><code class="language-xml">spark.hadoop.hive.metastore.uris=thrift://hive-metastore:9083
</code></pre>
<p>Then tables are created as <code>MANAGED</code> by default and stored in the directory specified by <code>spark.sql.warehouse.dir</code>.</p>
<p><img alt="" src="../images/custom-image-2024-06-25-20-08-39.png" /></p>
<p>You can still create Hive tables stored in the Hive warehouse. To do this, include:</p>
<pre><code class="language-python">.config(&quot;spark.hadoop.hive.metastore.uris&quot;, &quot;thrift://hive-metastore:9083&quot;) \
.enableHiveSupport() \
</code></pre>
<p>In this case, the tables will be <code>EXTERNAL</code> and stored in the directory specified by hive.<code>metastore.warehouse.dir</code> in <code>hive-site.xml</code></p>
<h1 id="errors"><span style="color: red;">Errors</span></h1>
<ul>
<li>
<p>If DB_DRIVER=derby in env var but hive-site.xml has no mssql connection:
<img alt="" src="../images/custom-image-2024-06-24-02-12-37.png" /></p>
</li>
<li>
<p>If you are unable to create folders or perform any operation. It could be the user 1001 is not having enough permissions. This is a typical user Bitnami spark configures to run the container.</p>
</li>
</ul>
<h1 id="server-details">Server Details</h1>
<table>
<thead>
<tr>
<th><strong>Configuration</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Hive Metastore URI</td>
<td><code>spark.hadoop.hive.metastore.uris=thrift://hive-metastore:9083</code></td>
</tr>
<tr>
<td>User and Database</td>
<td>User <code>dwdas</code> (PASSWORD=<code>Passw0rd</code>), Database <code>hive_metastore</code>.</td>
</tr>
<tr>
<td><strong>hive-site.xml</strong></td>
<td><strong>Details</strong></td>
</tr>
<tr>
<td><code>hive.metastore.warehouse.dir</code></td>
<td><code>/user/hive/warehouse</code></td>
</tr>
<tr>
<td><code>javax.jdo.option.ConnectionURL</code></td>
<td><code>jdbc:sqlserver://mssql:1433;databaseName=hive_metastore</code></td>
</tr>
<tr>
<td><strong>spark-defaults.conf</strong></td>
<td><strong>Details</strong></td>
</tr>
<tr>
<td><code>spark.sql.warehouse.dir</code></td>
<td><code>/data/spark-warehouse</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><strong>Service</strong></th>
<th><strong>Configuration Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Spark Server Configuration</strong></td>
<td></td>
</tr>
<tr>
<td>Image</td>
<td><code>spark:3.5.1-debian-12-r7</code></td>
</tr>
<tr>
<td>User running container</td>
<td><code>1001:1001</code></td>
</tr>
<tr>
<td>Environment Variables</td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>JAVA_HOME=/opt/bitnami/java</code></td>
</tr>
<tr>
<td></td>
<td><code>PYTHONPATH=/opt/bitnami/spark/python/</code></td>
</tr>
<tr>
<td></td>
<td><code>SPARK_HOME=/opt/bitnami/spark</code></td>
</tr>
<tr>
<td></td>
<td><code>SPARK_USER=spark</code></td>
</tr>
<tr>
<td></td>
<td><code>root: Passw0rd</code></td>
</tr>
<tr>
<td>Mounted Volume</td>
<td><code>shared-data:/data</code></td>
</tr>
<tr>
<td><strong>SQL Server Configuration</strong></td>
<td></td>
</tr>
<tr>
<td>Environment Variables</td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>SA_PASSWORD=Passw0rd</code></td>
</tr>
<tr>
<td></td>
<td><code>Server name: mssql</code></td>
</tr>
<tr>
<td></td>
<td><code>/opt/mssql/bin/sqlservr</code></td>
</tr>
<tr>
<td><strong>Hive Configuration</strong></td>
<td></td>
</tr>
<tr>
<td>Environment Variables</td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>HIVE_HOME=/opt/hive</code></td>
</tr>
<tr>
<td></td>
<td><code>SERVICE_NAME=metastore</code></td>
</tr>
<tr>
<td></td>
<td><code>DB_DRIVER=mssql</code></td>
</tr>
<tr>
<td></td>
<td><code>TEZ_HOME=/opt/tez</code></td>
</tr>
<tr>
<td></td>
<td><code>HIVE_VER=4.0.0</code></td>
</tr>
<tr>
<td></td>
<td><code>JAVA_HOME=/usr/local/openjdk-8</code></td>
</tr>
<tr>
<td></td>
<td><code>PWD=/home/dwdas</code></td>
</tr>
<tr>
<td></td>
<td><code>HADOOP_HOME=/opt/hadoop</code></td>
</tr>
<tr>
<td>Thrift Server URL</td>
<td><code>thrift://hive-metastore:9083</code></td>
</tr>
</tbody>
</table></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
