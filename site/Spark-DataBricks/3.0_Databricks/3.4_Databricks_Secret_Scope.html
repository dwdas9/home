
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dwdas9.github.io/home/Spark-DataBricks/3.0_Databricks/3.4_Databricks_Secret_Scope.html">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Secret Scope - Das Digital Digest</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#working-with-secret-scopes-in-azure-databricks" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="Das Digital Digest" class="md-header__button md-logo" aria-label="Das Digital Digest" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Das Digital Digest
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Secret Scope
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="Das Digital Digest" class="md-nav__button md-logo" aria-label="Das Digital Digest" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Das Digital Digest
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data Engineering & Analytics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Data Engineering & Analytics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Apache Airflow
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Apache Airflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Airflow/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Airflow/1.0.0_AirFlow_Concepts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Airflow/1.0.1_A_Dags_Anatomy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DAG Anatomy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Airflow/1.0.2_Hello_Airflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hello Airflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Airflow/1.0.3_Airflow_Dbt_Docker.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Airflow DBT Docker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Spark & Databricks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Spark & Databricks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced Topics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Stream Processing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Stream Processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../StreamProcessing/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SQL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            SQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL/best-practices.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL/performance-tuning.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Performance Tuning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cloud & DevOps
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Cloud & DevOps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Microsoft Fabric
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Microsoft Fabric
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Microsoft-Fabric/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Azure Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Azure Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Synapse-ADF/synapse.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Synapse Analytics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Synapse-ADF/adf.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Factory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DevOps
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            DevOps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_3_1" id="__nav_3_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GitHub Actions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_1">
            <span class="md-nav__icon md-icon"></span>
            GitHub Actions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DevOps/1_GitHub-Concepts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DevOps/1.1_Hello_GitHub_Actions_Workflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hello GitHub Actions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Azure DevOps
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            Azure DevOps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DevOps/2_Azure-Pipelines.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Pipelines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DevOps/ADF_CICD.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ADF CI/CD
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Containers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Containers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_1" >
        
          
          <label class="md-nav__link" for="__nav_3_4_1" id="__nav_3_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_1">
            <span class="md-nav__icon md-icon"></span>
            Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DockerAndKubernetes/AirflowDocker/1_AirflowDocker.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Airflow on Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DockerAndKubernetes/SparkHiveHadoop/4.9_DockerConcepts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DockerAndKubernetes/kubernetes/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Enterprise Solutions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Enterprise Solutions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Microsoft 365
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Microsoft 365
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../M365/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../M365/sharepoint.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SharePoint
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Power Platform
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Power Platform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PowerPlatform/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PowerPlatform/powerbi.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Power BI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PowerPlatform/automate.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Power Automate
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MongoDB
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            MongoDB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MongoDB/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MongoDB/best-practices.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Python/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Python/data-processing.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Python/automation.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Projects
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Projects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data Engineering
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Data Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DE-Projects/AzureSkyWeather/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Sky Weather
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DE-Projects/CurrencyPredictor.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Currency Predictor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DE-Projects/JsonValidator/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Validator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_4" id="__nav_5_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ETL Projects
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_4">
            <span class="md-nav__icon md-icon"></span>
            ETL Projects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DE-Projects/Csv-To-MSSQL.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSV to MSSQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DE-Projects/FetchJsonWriteParquet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON to Parquet
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DE-Projects/Dbrk-E2E-AttritionProject.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Databricks E2E Project
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Misc/6_RunningAppsInBg.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#different-types-of-secret-scopes" class="md-nav__link">
    <span class="md-ellipsis">
      Different Types of Secret Scopes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-databricks-backed-secret-scope" class="md-nav__link">
    <span class="md-ellipsis">
      Create Databricks-backed Secret Scope
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create Databricks-backed Secret Scope">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pre-requiesites" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-requiesites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pre-requiesites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-databricks-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Install Databricks CLI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-into-databricks-using-the-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Log into Databricks using the CLI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-secret-scope" class="md-nav__link">
    <span class="md-ellipsis">
      Create secret scope
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-azure-key-vault-managed-secret-scope" class="md-nav__link">
    <span class="md-ellipsis">
      Create Azure-Key-Vault-Managed Secret Scope
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-secret-scopes" class="md-nav__link">
    <span class="md-ellipsis">
      Working with secret scopes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Working with secret scopes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-secrets-to-scope" class="md-nav__link">
    <span class="md-ellipsis">
      Adding secrets to scope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listing-secrets-from-scope" class="md-nav__link">
    <span class="md-ellipsis">
      Listing Secrets from Scope
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Listing Secrets from Scope">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-azure-key-vault-backed-scopes" class="md-nav__link">
    <span class="md-ellipsis">
      List Azure-Key-Vault-Backed scopes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-databricks-backed-secret-scopes" class="md-nav__link">
    <span class="md-ellipsis">
      List Databricks-backed Secret scopes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-secret-scope" class="md-nav__link">
    <span class="md-ellipsis">
      Delete a Secret Scope
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connecting-adls-to-databricks-using-oauth2-with-service-principal-using-azure-backed-secret-scopes" class="md-nav__link">
    <span class="md-ellipsis">
      Connecting ADLS to Databricks using OAuth2 with Service Principal Using Azure-backed Secret Scopes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Connecting ADLS to Databricks using OAuth2 with Service Principal Using Azure-backed Secret Scopes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-check" class="md-nav__link">
    <span class="md-ellipsis">
      Quick check:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-secrets-in-azure-key-vault" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up Secrets in Azure Key Vault:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-for-oauth-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Code for OAuth Authentication:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_account-saforone-regappclientid-dbutilssecretsgetscopeazbackedscope-keyregappclientid-regappdirectoryid-dbutilssecretsgetscopeazbackedscope-keyregappdirectoryid-regappclientsecret-dbutilssecretsgetscopeazbackedscope-keyregappclientsecret-set-oauth-as-the-authentication-type-for-the-specified-storage-account-sparkconfsetffsazureaccountauthtypestorage_accountdfscorewindowsnet-oauth-define-the-token-provider-type-for-oauth-client-credentials-flow-sparkconfsetffsazureaccountoauthprovidertypestorage_accountdfscorewindowsnet-orgapachehadoopfsazurebfsoauth2clientcredstokenprovider-provide-the-application-client-id-of-the-azure-ad-registered-application-sparkconfsetffsazureaccountoauth2clientidstorage_accountdfscorewindowsnet-regappclientid-set-the-client-secret-of-the-registered-application-sparkconfsetffsazureaccountoauth2clientsecretstorage_accountdfscorewindowsnet-regappclientsecret-specify-the-oauth-20-token-endpoint-sparkconfsetffsazureaccountoauth2clientendpointstorage_accountdfscorewindowsnet-fhttpsloginmicrosoftonlinecomregappdirectoryidoauth2token-for-debugging-retrieve-and-print-the-client-id-configuration-printsparkconfgetffsazureaccountoauth2clientidstorage_accountdfscorewindowsnet" class="md-nav__link">
    <span class="md-ellipsis">
      storage_account = &quot;saforone&quot; regappClientID = dbutils.secrets.get(scope=&quot;azbackedscope&quot;, key=&quot;regappClientID&quot;) regappDirectoryID = dbutils.secrets.get(scope=&quot;azbackedscope&quot;, key=&quot;regappDirectoryID&quot;) regappClientSecret = dbutils.secrets.get(scope=&quot;azbackedscope&quot;, key=&quot;regappClientSecret&quot;) # Set OAuth as the authentication type for the specified storage account. spark.conf.set(f&quot;fs.azure.account.auth.type.{storage_account}.dfs.core.windows.net&quot;, &quot;OAuth&quot;) # Define the token provider type for OAuth (client credentials flow). spark.conf.set(f&quot;fs.azure.account.oauth.provider.type.{storage_account}.dfs.core.windows.net&quot;, &quot;org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider&quot;) # Provide the **Application (Client) ID** of the Azure AD registered application. spark.conf.set(f&quot;fs.azure.account.oauth2.client.id.{storage_account}.dfs.core.windows.net&quot;, regappClientID) # Set the client secret of the registered application. spark.conf.set(f&quot;fs.azure.account.oauth2.client.secret.{storage_account}.dfs.core.windows.net&quot;, regappClientSecret) # Specify the **OAuth 2.0 token endpoint**. spark.conf.set(f&quot;fs.azure.account.oauth2.client.endpoint.{storage_account}.dfs.core.windows.net&quot;, f&quot;https://login.microsoftonline.com/{regappDirectoryID}/oauth2/token&quot;) # For debugging: retrieve and print the client ID configuration. print(spark.conf.get(f&quot;fs.azure.account.oauth2.client.id.{storage_account}.dfs.core.windows.net&quot;))
    </span>
  </a>
  
    <nav class="md-nav" aria-label="storage_account = "saforone" regappClientID = dbutils.secrets.get(scope="azbackedscope", key="regappClientID") regappDirectoryID = dbutils.secrets.get(scope="azbackedscope", key="regappDirectoryID") regappClientSecret = dbutils.secrets.get(scope="azbackedscope", key="regappClientSecret") # Set OAuth as the authentication type for the specified storage account. spark.conf.set(f"fs.azure.account.auth.type.{storage_account}.dfs.core.windows.net", "OAuth") # Define the token provider type for OAuth (client credentials flow). spark.conf.set(f"fs.azure.account.oauth.provider.type.{storage_account}.dfs.core.windows.net", "org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider") # Provide the **Application (Client) ID** of the Azure AD registered application. spark.conf.set(f"fs.azure.account.oauth2.client.id.{storage_account}.dfs.core.windows.net", regappClientID) # Set the client secret of the registered application. spark.conf.set(f"fs.azure.account.oauth2.client.secret.{storage_account}.dfs.core.windows.net", regappClientSecret) # Specify the **OAuth 2.0 token endpoint**. spark.conf.set(f"fs.azure.account.oauth2.client.endpoint.{storage_account}.dfs.core.windows.net", f"https://login.microsoftonline.com/{regappDirectoryID}/oauth2/token") # For debugging: retrieve and print the client ID configuration. print(spark.conf.get(f"fs.azure.account.oauth2.client.id.{storage_account}.dfs.core.windows.net"))">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-errors-and-resolutions" class="md-nav__link">
    <span class="md-ellipsis">
      Common Errors And Resolutions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Errors And Resolutions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-vault-access-denied" class="md-nav__link">
    <span class="md-ellipsis">
      Key Vault Access Denied
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deniedwithnovalidrbac" class="md-nav__link">
    <span class="md-ellipsis">
      DeniedWithNoValidRBAC
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#-" class="md-nav__link">
    <span class="md-ellipsis">
      ---
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<details open markdown="block">
  <summary>
    Table of contents
  </summary>
  {: .text-delta }
1. TOC
{:toc}
</details>

<h1 id="working-with-secret-scopes-in-azure-databricks">Working with Secret Scopes in Azure Databricks<a class="headerlink" href="#working-with-secret-scopes-in-azure-databricks" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Azure Databricks offers two secret scopes: Azure Key Vault-backed and Databricks-backed. This guide walks you through their creation, access in PySpark, and prerequisites such as Databricks CLI installation and understanding key vault-related roles. By the end, you'll possess all the fundamental knowledge required to use key vaults with Azure Databricks.</p>
<h2 id="different-types-of-secret-scopes">Different Types of Secret Scopes<a class="headerlink" href="#different-types-of-secret-scopes" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Databricks-backed Secret Scope</strong>: 
   This is a proprietary scope managed by Databricks. Secrets stored in this scope are encrypted and can be accessed only by users with the necessary permissions.</p>
</li>
<li>
<p><strong>Azure key-vault backed Secret Scope</strong>: 
   If you create a secret scope in Databricks that references an Azure Key Vault, then the scope is Azure Key Vault-backed. The actual secrets are stored in Azure Key Vault, and Databricks retrieves them from there when needed.</p>
</li>
</ol>
<h2 id="create-databricks-backed-secret-scope">Create Databricks-backed Secret Scope<a class="headerlink" href="#create-databricks-backed-secret-scope" title="Permanent link">&para;</a></h2>
<h3 id="pre-requiesites">Pre-requiesites<a class="headerlink" href="#pre-requiesites" title="Permanent link">&para;</a></h3>
<p>You may need to install databricks CLI if you don't have it installed already.</p>
<h4 id="install-databricks-cli">Install Databricks CLI<a class="headerlink" href="#install-databricks-cli" title="Permanent link">&para;</a></h4>
<p>Databricks-backed secret scopes are created using the Databricks CLI and Secrets API. The #secrets/createScope UI in Databricks is reserved for Azure Key Vault-backed secret scopes. Thus, we'll employ the Databricks CLI for this task:</p>
<ol>
<li>Ensure you have Python installed on your system.</li>
<li>Use pip, Pythons package manager, to install the CLI:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pip<span class="w"> </span>install<span class="w"> </span>databricks-cli
</span></code></pre></div></li>
</ol>
<h4 id="log-into-databricks-using-the-cli">Log into Databricks using the CLI<a class="headerlink" href="#log-into-databricks-using-the-cli" title="Permanent link">&para;</a></h4>
<p>Once the CLI is installed, the next step is to log in to your Databricks workspace:</p>
<ol>
<li>
<p>Open a terminal or command prompt and enter
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>databricks<span class="w"> </span>configure<span class="w"> </span>--token
</span></code></pre></div></p>
</li>
<li>
<p>You will be asked to enter Host. Copy the databricks URI from the browser which will be of format, <code>https://&lt;databricks-instance&gt;#workspace</code>.</p>
</li>
<li>
<p>You'll be prompted for a Token. In the Databricks UI's top-right, go to User Settings &gt; Developer Tab &gt; 'Generate new token'. Set a name, validity days, and click 'Generate'. Copy the token and paste in the CLI.</p>
<p><span style="color:blue">Note:</span> The databricks Host and token is saved inside <span style="color:red">"C:\Users\user-name\databrickscfg"</span></p>
</li>
</ol>
<p><a class="glightbox" href="images/dbrkconfig.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/dbrkconfig.png" /></a></p>
<h3 id="create-secret-scope">Create secret scope<a class="headerlink" href="#create-secret-scope" title="Permanent link">&para;</a></h3>
<p>Suppose you want to create a secret scope with the following details:</p>
<ul>
<li><strong>Scope Name</strong>: <code>my-scope</code></li>
<li><strong>Backend Type</strong>: Databricks-managed (i.e., <code>DATABRICKS</code>)</li>
<li><strong>Initial Manage Principal</strong>: <code>users</code> (Means, all users. Must for non-premium acts)</li>
</ul>
<p>With these details, the command will look like:</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>databricks<span class="w"> </span>secrets<span class="w"> </span>create-scope<span class="w"> </span>--scope<span class="w"> </span>myscope<span class="w"> </span>--scope-backend-type<span class="w"> </span>DATABRICKS<span class="w"> </span>--initial-manage-principal<span class="w"> </span>users
</span></code></pre></div>
<a class="glightbox" href="images/image.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/image.png" /></a></p>
<p><span style="color:blue"><strong>Note:</strong></span> 
<span style="color:black">In Databricks, when creating a secret scope, the default assigns <code>MANAGE</code> permission only to the creator. For non-Premium accounts, override this by granting <code>MANAGE</code> permission to all users using </span><span style="color:red"><code>--initial-manage-principal users</code></span><span style="color:black"> during scope creation.</span></p>
<h2 id="create-azure-key-vault-managed-secret-scope">Create Azure-Key-Vault-Managed Secret Scope<a class="headerlink" href="#create-azure-key-vault-managed-secret-scope" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Create a Key Vault</strong>: Set up a Key Vault in Azure using the standard way.</p>
</li>
<li>
<p><strong>Get Key Vault Details</strong>: Go to the 'Properties' of your Key Vault and make a note of the 'Vault URI' and 'Resource ID'.</p>
</li>
<li>
<p><strong>Open Databricks Secret Scope UI</strong>: </p>
</li>
<li>Go to your Databricks URL.</li>
<li>
<p>Add <code>#secrets/createScope</code> right after <code>.net</code>. 'S' is caps. Here's how it should look:</p>
<p><a href="https://databricks-instance.azuredatabricks.net#secrets/createScope">https://databricks-instance.azuredatabricks.net#secrets/createScope</a></p>
</li>
</ol>
<p>This is a workaround, as there's no direct link in the UI to this page.</p>
<ol>
<li><strong>Set Up the Secret Scope</strong>:</li>
<li>Give it a name under 'Scope'.</li>
<li>Pick a 'Manage Principal'.</li>
<li>In the 'DNS Name' field, put the 'Vault URI' you copied earlier from Key Vault properties.</li>
<li>
<p>For 'Resource ID', use the 'Resource ID' you noted down, something like:</p>
<p><code>/subscriptions/someid/resourceGroups/resgropname/providers/Microsoft.KeyVault/vaults/keyvaultname</code>
<a class="glightbox" href="images/vaulturiresid.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/vaulturiresid.png" /></a>
5. <strong>Create the Secret Scope</strong>: Click 'Create'. After you do, you'll get a confirmation. But keep in mind, once created, you can't see this scope in the Databricks UI. To check it, you'll have to use the <code>databricks secrets list-scopes</code> command in the Databricks CLI.</p>
</li>
</ol>
<p><a class="glightbox" href="images/createsecretsuccess.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/createsecretsuccess.png" /></a></p>
<ol>
<li><strong>Check the Secret Scope</strong>: Keep in mind, once created, you can't see this scope in the Databricks UI. To check it, you'll have to use the <code>databricks secrets list-scopes</code> command in the Databricks CLI.
<a class="glightbox" href="images/listscope.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/listscope.png" /></a></li>
</ol>
<h2 id="working-with-secret-scopes">Working with secret scopes<a class="headerlink" href="#working-with-secret-scopes" title="Permanent link">&para;</a></h2>
<h3 id="adding-secrets-to-scope">Adding secrets to scope<a class="headerlink" href="#adding-secrets-to-scope" title="Permanent link">&para;</a></h3>
<p>Add secrets to Databricks scopes using dbrk CLI. For azure-key-vault-backed secrets, use the Azure portal. Ensure admin role on the azure keyvault, even if you created it. More details in the following sections.</p>
<p><strong>Add Secret to Databricks-backed scope</strong>:</p>
<p>To add run the following command in databricks CLI</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>databricks<span class="w"> </span>secrets<span class="w"> </span>put<span class="w"> </span>--scope<span class="w"> </span>&lt;scope-name&gt;<span class="w"> </span>--key<span class="w"> </span>&lt;key-name&gt;<span class="w"> </span>--string-value<span class="w"> </span>&lt;your-actual-secret-value&gt;
</span></code></pre></div>
<p>If your secret is stored in a file, you can use the following instead:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>databricks<span class="w"> </span>secrets<span class="w"> </span>put<span class="w"> </span>--scope<span class="w"> </span>&lt;scope-name&gt;<span class="w"> </span>--key<span class="w"> </span>&lt;key-name&gt;<span class="w"> </span>--binary-file<span class="w"> </span>&lt;path-to-file&gt;
</span></code></pre></div>
<p><strong>Add Secret to Azure-Key-Vault-backed scope</strong>:</p>
<p><span style="color:blue"><strong>Note:</strong></span> 
<span style="color:black">To add secrets in Azure Key Vault, you must use the Azure SetSecret REST API or Azure portal UI. <code>Put</code> operation using databricks CLI will NOT work. </span><span></p>
<p><a class="glightbox" href="images/add_secret_wont_work_azkeyvault.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/add_secret_wont_work_azkeyvault.png" /></a></p>
<h3 id="listing-secrets-from-scope">Listing Secrets from Scope<a class="headerlink" href="#listing-secrets-from-scope" title="Permanent link">&para;</a></h3>
<h4 id="list-azure-key-vault-backed-scopes">List Azure-Key-Vault-Backed scopes<a class="headerlink" href="#list-azure-key-vault-backed-scopes" title="Permanent link">&para;</a></h4>
<p>To list Azure Key Vault-backed scopes, run <code>dbutils.secrets.list(scope='az-kv-backed-secret-scope-name')</code>, in Azure Databricks. </p>
<p><strong>Remember:</strong></p>
<ol>
<li>Databricks interacts with Azure Key Vault using the <strong>AzureDatabricks</strong> application identity, not the logged-in user's identity.</li>
<li>Grant required <strong>role to AzureDatabricks app</strong> in Azure Key Vault:</li>
<li>Open your Azure Key Vault.</li>
<li>Go to <strong>Access control(IAM)</strong>, <strong>Role assignments</strong>. Click <strong>Add Icon</strong>. Select <strong>Add role assignment</strong>.
  <a class="glightbox" href="images/image11.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/image11.png" /></a></li>
<li>In the <strong>Members tab</strong>, select the desired role, e.g. <strong>Key Vaults Secrets</strong>.User, click next
  <a class="glightbox" href="images/image-12.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/image-12.png" /></a></li>
<li>Now click on <strong>Select members</strong> and choose <strong>AzureDatabricks</strong>. Then click <strong>Select</strong>.
  <a class="glightbox" href="images/image-21.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/image-21.png" /></a></li>
<li>Finally click <strong>Review + assign</strong>
  <a class="glightbox" href="images/image-31.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/image-31.png" /></a></li>
<li>Finally you can run the list command in databricks without issues
   <a class="glightbox" href="images/image-11.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/image-11.png" /></a></li>
</ol>
<h4 id="list-databricks-backed-secret-scopes">List Databricks-backed Secret scopes<a class="headerlink" href="#list-databricks-backed-secret-scopes" title="Permanent link">&para;</a></h4>
<p>To list Databricks-backed scopes, run <code>dbutils.secrets.list(scope='databricks-backed-scope-name')</code>, in Databricks. This is relatively simple operation and doesn't require additinal roles in Azure.</p>
<h3 id="delete-a-secret-scope">Delete a Secret Scope<a class="headerlink" href="#delete-a-secret-scope" title="Permanent link">&para;</a></h3>
<p>To delete a specific secret scope:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>databricks<span class="w"> </span>secrets<span class="w"> </span>delete-scope<span class="w"> </span>--scope<span class="w"> </span>&lt;scope-name&gt;
</span></code></pre></div>
<p>Replace <code>&lt;scope-name&gt;</code> with the name of the secret scope you wish to delete.</p>
<p><strong>Caution</strong>: Be certain about deleting a secret scope, as this action cannot be undone and any secrets within the scope will be permanently removed.</p>
<hr />
<h2 id="connecting-adls-to-databricks-using-oauth2-with-service-principal-using-azure-backed-secret-scopes">Connecting ADLS to Databricks using OAuth2 with Service Principal Using Azure-backed Secret Scopes<a class="headerlink" href="#connecting-adls-to-databricks-using-oauth2-with-service-principal-using-azure-backed-secret-scopes" title="Permanent link">&para;</a></h2>
<h3 id="quick-check">Quick check:<a class="headerlink" href="#quick-check" title="Permanent link">&para;</a></h3>
<ul>
<li>Ensure you have an <strong>Azure Key Vault</strong> set up.</li>
<li>The <strong>Azure Key Vault</strong> should be configured as the backend of the Databricks Azure-backed <strong>Secret Scope</strong> you've created.</li>
<li>To execute <strong>dbutils.secrets.get</strong> an App callled <strong>AzureDatabricks</strong> should have role added to the Azure Keyvault</li>
<li>Refer to <strong>Common Error</strong> section to see common errors for such operations</li>
</ul>
<h3 id="setting-up-secrets-in-azure-key-vault">Setting Up Secrets in Azure Key Vault:<a class="headerlink" href="#setting-up-secrets-in-azure-key-vault" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Using the steps below add 3 entries in Azure KeyVault</strong>:<ul>
<li>Navigate to the <strong>Azure Key Vault</strong> that's linked to the Databricks <strong>Secret Scope</strong> you created.</li>
<li>Under <strong>Secrets</strong>, click on the '+ Generate/Import' option.</li>
<li>Add the following three secret entries:<ol>
<li><strong>regappDirectoryID</strong>: This is the <strong>Directory (Tenant) ID</strong> found under the 'Overview' section of your registered application in Azure.</li>
<li><strong>regappClientID</strong>: This is the <strong>Application (Client) ID</strong>, also found under the 'Overview' section of your registered app.</li>
<li><strong>regappClientSecret</strong>: Navigate to <strong>Certificates and Secrets</strong> in your registered app. Create a <strong>New Client Secret</strong> and use its value here.
<a class="glightbox" href="images/addkeys.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/addkeys.png" /></a></li>
</ol>
</li>
</ul>
</li>
</ol>
<h3 id="code-for-oauth-authentication">Code for OAuth Authentication:<a class="headerlink" href="#code-for-oauth-authentication" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Code for OAuth Authentication</strong>:
    To access a file in ADLS, use the following code:</p>
<h2 id="storage_account-saforone-regappclientid-dbutilssecretsgetscopeazbackedscope-keyregappclientid-regappdirectoryid-dbutilssecretsgetscopeazbackedscope-keyregappdirectoryid-regappclientsecret-dbutilssecretsgetscopeazbackedscope-keyregappclientsecret-set-oauth-as-the-authentication-type-for-the-specified-storage-account-sparkconfsetffsazureaccountauthtypestorage_accountdfscorewindowsnet-oauth-define-the-token-provider-type-for-oauth-client-credentials-flow-sparkconfsetffsazureaccountoauthprovidertypestorage_accountdfscorewindowsnet-orgapachehadoopfsazurebfsoauth2clientcredstokenprovider-provide-the-application-client-id-of-the-azure-ad-registered-application-sparkconfsetffsazureaccountoauth2clientidstorage_accountdfscorewindowsnet-regappclientid-set-the-client-secret-of-the-registered-application-sparkconfsetffsazureaccountoauth2clientsecretstorage_accountdfscorewindowsnet-regappclientsecret-specify-the-oauth-20-token-endpoint-sparkconfsetffsazureaccountoauth2clientendpointstorage_accountdfscorewindowsnet-fhttpsloginmicrosoftonlinecomregappdirectoryidoauth2token-for-debugging-retrieve-and-print-the-client-id-configuration-printsparkconfgetffsazureaccountoauth2clientidstorage_accountdfscorewindowsnet"><div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">storage_account</span> <span class="o">=</span> <span class="s2">&quot;saforone&quot;</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">regappClientID</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">secrets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;azbackedscope&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;regappClientID&quot;</span><span class="p">)</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">regappDirectoryID</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">secrets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;azbackedscope&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;regappDirectoryID&quot;</span><span class="p">)</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">regappClientSecret</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">secrets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;azbackedscope&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;regappClientSecret&quot;</span><span class="p">)</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c1"># Set OAuth as the authentication type for the specified storage account.</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fs.azure.account.auth.type.</span><span class="si">{</span><span class="n">storage_account</span><span class="si">}</span><span class="s2">.dfs.core.windows.net&quot;</span><span class="p">,</span> <span class="s2">&quot;OAuth&quot;</span><span class="p">)</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="c1"># Define the token provider type for OAuth (client credentials flow).</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fs.azure.account.oauth.provider.type.</span><span class="si">{</span><span class="n">storage_account</span><span class="si">}</span><span class="s2">.dfs.core.windows.net&quot;</span><span class="p">,</span> <span class="s2">&quot;org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider&quot;</span><span class="p">)</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="c1"># Provide the **Application (Client) ID** of the Azure AD registered application.</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fs.azure.account.oauth2.client.id.</span><span class="si">{</span><span class="n">storage_account</span><span class="si">}</span><span class="s2">.dfs.core.windows.net&quot;</span><span class="p">,</span> <span class="n">regappClientID</span><span class="p">)</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="c1"># Set the client secret of the registered application.</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fs.azure.account.oauth2.client.secret.</span><span class="si">{</span><span class="n">storage_account</span><span class="si">}</span><span class="s2">.dfs.core.windows.net&quot;</span><span class="p">,</span> <span class="n">regappClientSecret</span><span class="p">)</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="c1"># Specify the **OAuth 2.0 token endpoint**.</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fs.azure.account.oauth2.client.endpoint.</span><span class="si">{</span><span class="n">storage_account</span><span class="si">}</span><span class="s2">.dfs.core.windows.net&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;https://login.microsoftonline.com/</span><span class="si">{</span><span class="n">regappDirectoryID</span><span class="si">}</span><span class="s2">/oauth2/token&quot;</span><span class="p">)</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="c1"># For debugging: retrieve and print the client ID configuration.</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="nb">print</span><span class="p">(</span><span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fs.azure.account.oauth2.client.id.</span><span class="si">{</span><span class="n">storage_account</span><span class="si">}</span><span class="s2">.dfs.core.windows.net&quot;</span><span class="p">))</span>
</span></code></pre></div><a class="headerlink" href="#storage_account-saforone-regappclientid-dbutilssecretsgetscopeazbackedscope-keyregappclientid-regappdirectoryid-dbutilssecretsgetscopeazbackedscope-keyregappdirectoryid-regappclientsecret-dbutilssecretsgetscopeazbackedscope-keyregappclientsecret-set-oauth-as-the-authentication-type-for-the-specified-storage-account-sparkconfsetffsazureaccountauthtypestorage_accountdfscorewindowsnet-oauth-define-the-token-provider-type-for-oauth-client-credentials-flow-sparkconfsetffsazureaccountoauthprovidertypestorage_accountdfscorewindowsnet-orgapachehadoopfsazurebfsoauth2clientcredstokenprovider-provide-the-application-client-id-of-the-azure-ad-registered-application-sparkconfsetffsazureaccountoauth2clientidstorage_accountdfscorewindowsnet-regappclientid-set-the-client-secret-of-the-registered-application-sparkconfsetffsazureaccountoauth2clientsecretstorage_accountdfscorewindowsnet-regappclientsecret-specify-the-oauth-20-token-endpoint-sparkconfsetffsazureaccountoauth2clientendpointstorage_accountdfscorewindowsnet-fhttpsloginmicrosoftonlinecomregappdirectoryidoauth2token-for-debugging-retrieve-and-print-the-client-id-configuration-printsparkconfgetffsazureaccountoauth2clientidstorage_accountdfscorewindowsnet" title="Permanent link">&para;</a></h2>
</li>
</ol>
<h3 id="common-errors-and-resolutions">Common Errors And Resolutions<a class="headerlink" href="#common-errors-and-resolutions" title="Permanent link">&para;</a></h3>
<h4 id="key-vault-access-denied">Key Vault Access Denied<a class="headerlink" href="#key-vault-access-denied" title="Permanent link">&para;</a></h4>
<p>When attempting to add keys to the key vault, one might encounter errors such as:</p>
<blockquote>
<p>The operation is not allowed by RBAC.
<a class="glightbox" href="images/image121.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/image121.png" /></a></p>
</blockquote>
<p><strong>Solution</strong>: Assign a role like <strong>Key Vault Administrator</strong> to the logged-in user. This should allow the user to add or remove keys.
<a class="glightbox" href="images/image-121.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/image-121.png" /></a></p>
<hr />
<h4 id="deniedwithnovalidrbac">DeniedWithNoValidRBAC<a class="headerlink" href="#deniedwithnovalidrbac" title="Permanent link">&para;</a></h4>
<p>After addressing the first issue, another challenge might arise. When trying to access keys from Databricks using commands like <code>dbutils.secrets.list(scope='foronescope')</code>, errors such as <strong>DeniedWithNoValidRBAC</strong> and <strong>ForbiddenByRbac</strong> might appear.
<a class="glightbox" href="images/image-211.png" data-type="image" data-width="100%" data-height="auto" data-title="Alt text" data-desc-position="bottom"><img alt="Alt text" src="images/image-211.png" /></a></p>
<p><strong>Root Cause</strong>: Insufficient permission for AzureDatabricks Identity. A hint lies in the error log:</p>
<blockquote>
<p>Caller: name=AzureDatabricks;appid=2ff814a6-3304-4ab8-85cb-cd0e6f879c1d</p>
</blockquote>
<p><strong>Solution</strong>: Recognize that it's the AzureDatabricks service's identity Azure evaluates, not our group identity. Ensure AzureDatabricks has the right permissions, especially the Admin role.</p>
<blockquote>
<p><strong>Reference</strong>: A related issue can be found in <a href="#">this GitHub discussion</a>.</p>
<p>Summary: 
1. For <strong>AzureDatabricks</strong>: Assign the Admin role.
2. Assign the <strong>Key Vault Administrator</strong> role to the logged-in user</p>
</blockquote>
<h2 id="-">---<a class="headerlink" href="#-" title="Permanent link">&para;</a></h2>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 - Das
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>